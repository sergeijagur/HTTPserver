<!DOCTYPE html>
<html>
<head>
    <title>HTTP server exercise</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/x-icon" href="../pictures/favicon.ico">
</head>
<body>
<br>
<br>
<button value="" onclick="window.location.href='../pictures/photo.jpeg'">Picture</button>
<br>
<br>
<button value="" onclick="logOut()">Remove authentication info</button>
<br>
<h1>
    PERSONAL CODE GENERATOR
</h1>
<button value="" onclick="window.location.href='http://localhost:8080/personal-code-generator.html'">Personal code generator</button>
<br>
<h1>
    SALARY CALCULATOR
</h1>
<button value="" onclick="window.location.href='http://localhost:8080/salary-calculator.html'">Salary calculator</button>
<br>
<br>
<button value="" onclick="window.location.href='http://localhost:8080/salary-json.html'">Salary calculator (JSON )</button>
<br>
<h1>
    PERSONAL CODE CONTROLLER
</h1>
<form action="" method="GET">
    <input type="number" id="personalcode" name="personalcode" required  placeholder="isikukood" min="1000000000" max="99999999999">
    <label for="personalcode">Personal Code</label>
    <br>
    <br>
    <button type="submit" id="submit">Control personal code</button>
    <br>
</form>
<h1>
    ADD PERSON TO LIST
</h1>
<form action="" method="POST">
    <input type="text" name="firstName" id="firstName">
    <lab for="firstName">First name</lab>
    <br>
    <br>
    <input type="text" name="lastName" id="lastName">
    <lab for="lastName">Last name</lab>
    <br>
    <br>
    <input type="date" name="birthDay" id="birthDay">
    <lab for="birthDay">Birthday</lab>
    <br>
    <br>
    <input type="number" id="pk" name="pk" required  placeholder="isikukood" min="1000000000" max="99999999999">
    <label for="pk">Personal Code</label>
    <br>
    <br>
    <button type="submit" id="sbm">Add to list</button>
    <br>
</form>
<h1>
    UPLOAD FILE
</h1>
<form method="POST" action="fileuploadservlet" enctype="multipart/form-data">
    <input type="file" name="file" id="file" />
    <input type="submit" onclick="send()" value="Upload" />
</form>

<h1>
    SEND/GET DATA WITH JSON
</h1>
<button value="" onclick="window.location.href='http://localhost:8080/data.html'">JSON</button>
<br>




</body>
</html>
<script>

    function logOut() {
        const xhr = new XMLHttpRequest();
        xhr.open("GET", 'http://localhost:8080/logout', true);
        xhr.setRequestHeader("Authorization", "Basic logout");
        xhr.send();
    setTimeout(function () {
        window.location.href = 'http://localhost:8080/';
    }, 200);
    }

    function send() {

        let formData = new FormData();
        formData.append('file', document.getElementById('file').value);
        const xhr = new XMLHttpRequest();
        const url = "http://localhost:8080/fileuploadservlet";
        xhr.open("POST", url, true);
        // xhr.setRequestHeader("Content-Type", "multipart/form-data");
        // xhr.onreadystatechange = function () {
        //     if (xhr.readyState === 4 && xhr.status === 200) {
        //         // document.write(this.responseText);
        //         const Data = JSON.parse(xhr.responseText);
        //         document.getElementById('first').value = Data.firstName;
        //         document.getElementById('last').value = Data.lastName;
        //         document.getElementById('bd').value = Data.dateOfBirth;
        //         document.getElementById('pk').value = Data.personalCode;
        //         // document.getElementById('bd').value = Data.birthDay;
        //     }
        // };
        xhr.send(formData);
    }

</script>